(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{189:function(s,n,a){"use strict";a.r(n);var e=a(0),t=Object(e.a)({},function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#容器","aria-hidden":"true"}},[s._v("#")]),s._v(" 容器")]),s._v(" "),a("h2",{attrs:{id:"构建镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像","aria-hidden":"true"}},[s._v("#")]),s._v(" 构建镜像")]),s._v(" "),a("p",[s._v("压缩项目构建产物dist目录，按如下方法构建：")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("Dockerfile")]),s._v("：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("FROM nginx\nCOPY mysite.template /etc/nginx\nADD dist.tar.gz /usr/share/nginx/html\nRUN /bin/bash -c 'chmod -R 777 /usr/share/nginx/html/dist'\nCMD envsubst '$BASE_PATH $BACK_END_URL $SERVER_NAME' < /etc/nginx/mysite.template > /etc/nginx/conf.d/default.conf && exec nginx -g 'daemon off;'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[a("code",[s._v("mysite.template")]),s._v("：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("server {\n  listen              80;\n  server_name  ${SERVER_NAME};\n\n  location / {\n      root /usr/share/nginx/html;\n      index  ${BASE_PATH}index.html ${BASE_PATH}index.htm;\n  }\n\n  location ${BASE_PATH}api/ {\n      rewrite  ^${BASE_PATH}api/(.*)$ /$1 break;\n      # api请求指向后台接口\n      proxy_pass   ${BACK_END_URL};\n  }\n\n  location ${BASE_PATH} {\n      alias /usr/share/nginx/html${BASE_PATH};\n      index  ${BASE_PATH}index.html;\n      # uri重定向至index.html\n      try_files $uri $uri/ ${BASE_PATH}index.html;\n  }\n}\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行","aria-hidden":"true"}},[s._v("#")]),s._v(" 运行")]),s._v(" "),a("p",[s._v("以docker-compose为例："),a("code",[s._v("docker-compose.yml")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('web:\n  image: demo:test\n  ports:\n   - "8080:80"\n  environment:\n   - SERVER_NAME=localhost\n   - BASE_PATH=/\n   - BACK_END_URL=http://localhost:8000/\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])])},[],!1,null,null,null);n.default=t.exports}}]);